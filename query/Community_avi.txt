--보드만들기!

CREATE TABLE BOARD( 
  BID NUMBER PRIMARY KEY,
  BTYPE NUMBER, --�Խ���Ÿ�� 1 �����Խ��� 2 ����
  CID NUMBER,
  BTITLE VARCHAR2(200),
  BCONTENT CLOB,
  BWRITER VARCHAR2(30),
  BGOOD NUMBER DEFAULT 0,
  BCOUNT NUMBER DEFAULT 0,
  BYOUTUBEADDRESS VARCHAR2(4000),
  CREATE_DATE DATE,
  MODIFY_DATE DATE,
  STATUS VARCHAR2(1) DEFAULT 'Y' CHECK (STATUS IN('Y', 'N')),

  );
CREATE SEQUENCE SEQ_BID;
--grant create view to cono -- view 생성안될때 이거쓰세요


--영상 게시판 뷰
CREATE OR REPLACE VIEW BLIST
AS
SELECT ROWNUM RNUM,BID, BTYPE, CID,BTITLE,BCONTENT,BWRITER,BGOOD,BCOUNT,BYOUTUBEADDRESS,CREATE_DATE,MODIFY_DATE,STATUS
FROM BOARD WHERE STATUS = 'Y' AND BTYPE ='2';

--추천테이블
CREATE TABLE GOOD( 

    BID NUMBER NOT NULL,
    USERID VARCHAR2(100) NOT NULL,
    BWRITER VARCHAR2(100) NOT NULL,
    GOOD_CHECK NUMBER DEFAULT 0 NULL,

    CONSTRAINT GOODKEY PRIMARY KEY(BID,USERID)
 


    );
    
 --댓글테이블   
CREATE TABLE AREPLY(
    RID NUMBER PRIMARY KEY,
    RCONTENT CLOB,
    RWRITER VARCHAR(100),
    REF_ABID NUMBER,
    CREATE_DATE DATE,
    MODIFY_DATE DATE,
    STATUS VARCHAR(5) default 'Y'
    );
    
   
    
    
  
    
CREATE SEQUENCE SEQ_RID;  

CREATE  VIEW ARLIST
AS 
SELECT ROWNUM RNUM, RID,RCONTENT,RWRITER,REF_ABID,CREATE_DATE,MODIFY_DATE,status
FROM AREPLY WHERE STATUS ='Y';

--추천 VIEW

 CREATE VIEW GOODLIST AS
    SELECT BID,USERID,BWRITER,GOOD_CHECK FROM GOOD WHERE GOOD_CHECK=1;


--CREATE SEQUENCE SEQ_RID;  
-----------------------------------------------------------------------------------------------------------------
-- 1. BOARD ����Ʈ BID �������� ���� ���� 
SELECT BID, BTYPE, CNAME, BTITLE, BCONTENT, NICKNAME, BCOUNT, B.CREATE_DATE, B.MODIFY_DATE, B.STATUS
FROM BOARD B
JOIN MEMBER M ON(B.BWRITER = M.USER_ID)
JOIN CATEGORY C ON(B.CID = C.CID)
WHERE B.STATUS = 'Y'
ORDER BY BID DESC;

-- 2. �ζ��� �� ROWNUM Ȱ��   --> ����Ʈ ��½� �̿� ��ȹ
SELECT ROWNUM, BID, BTYPE, CNAME, BTITLE, BCONTENT, NICKNAME, BCOUNT, CREATE_DATE, MODIFY_DATE, STATUS
FROM (SELECT BID, BTYPE, CNAME, BTITLE, BCONTENT, NICKNAME, BCOUNT, B.CREATE_DATE, B.MODIFY_DATE, B.STATUS
      FROM BOARD B
      JOIN MEMBER M ON(B.BWRITER = M.USER_ID)
      JOIN CATEGORY C ON(B.CID = C.CID)
      WHERE B.STATUS = 'Y'
      ORDER BY BID DESC)
WHERE BTYPE = 1 AND ROWNUM BETWEEN 1 AND 10;



 -- CREATE OR REPLACE FORCE VIEW "JSP_SERVLET"."BLIST" ("RNUM", "BID", "BTYPE", "CNAME", "BTITLE", "BCONTENT", "NICKNAME", "BCOUNT", "CREATE_DATE", "MODIFY_DATE", "STATUS") AS 
  SELECT ROWNUM RNUM, BID, BTYPE, CNAME, BTITLE, BCONTENT, NICKNAME, BCOUNT, CREATE_DATE, MODIFY_DATE, STATUS
FROM (SELECT BID, BTYPE, CNAME, BTITLE, BCONTENT, NICKNAME, BCOUNT, B.CREATE_DATE, B.MODIFY_DATE, B.STATUS
      FROM BOARD B
      JOIN MEMBER M ON(B.BWRITER = M.USER_ID)
      JOIN CATEGORY C ON(B.CID = C.CID)
      WHERE B.STATUS = 'Y'
      ORDER BY BID DESC);
      
      
 DROP TABLE AREPLY;
drop view arlist;

--drop sequence SEQ_BID;
commit;
-- BOARD ��ȸ�� ������ ���� 
