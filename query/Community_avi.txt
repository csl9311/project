--커뮤니티 테이블생성
CREATE TABLE BOARD( 
  BID NUMBER PRIMARY KEY,
  BTYPE NUMBER, --게시판타입 1 자유게시판 2 영상
  CID NUMBER,
  BTITLE VARCHAR2(200),
  BCONTENT CLOB,
  BWRITER VARCHAR2(30),
  BGOOD NUMBER DEFAULT 0,
  BCOUNT NUMBER DEFAULT 0,
  BYOUTUBEADDRESS VARCHAR2(4000),
  CREATE_DATE DATE,
  MODIFY_DATE DATE,
  STATUS VARCHAR2(1) DEFAULT 'Y' CHECK (STATUS IN('Y', 'N')),
  FOREIGN KEY (BWRITER) REFERENCES MEMBER
  );
--CREATE SEQUENCE SEQ_BID;
--drop sequence SEQ_BID;
commit;
-- BOARD 조회용 쿼리문 관련 
grant create view to cono -- view 생성권한 해줘연
CREATE OR REPLACE VIEW BLIST
AS
SELECT BID, BTYPE, CID,BTITLE,BCONTENT,BWRITER,BGOOD,BCOUNT,BYOUTUBEADDRESS,CREATE_DATE,MODIFY_DATE,STATUS
FROM BOARD WHERE STATUS = 'Y' AND BTYPE ='2';


CREATE TABLE GOOD( --좋아요 테이블

    BID NUMBER NOT NULL PRIMARY KEY,
    USERID VARCHAR2(100) NOT NULL,
    GOOD_CHECK NUMBER DEFAULT 0 NULL
    )




-- 1. BOARD 리스트 BID 내림차순 정렬 기준 
SELECT BID, BTYPE, CNAME, BTITLE, BCONTENT, NICKNAME, BCOUNT, B.CREATE_DATE, B.MODIFY_DATE, B.STATUS
FROM BOARD B
JOIN MEMBER M ON(B.BWRITER = M.USER_ID)
JOIN CATEGORY C ON(B.CID = C.CID)
WHERE B.STATUS = 'Y'
ORDER BY BID DESC;

-- 2. 인라인 뷰 ROWNUM 활용   --> 리스트 출력시 이용 계획
SELECT ROWNUM, BID, BTYPE, CNAME, BTITLE, BCONTENT, NICKNAME, BCOUNT, CREATE_DATE, MODIFY_DATE, STATUS
FROM (SELECT BID, BTYPE, CNAME, BTITLE, BCONTENT, NICKNAME, BCOUNT, B.CREATE_DATE, B.MODIFY_DATE, B.STATUS
      FROM BOARD B
      JOIN MEMBER M ON(B.BWRITER = M.USER_ID)
      JOIN CATEGORY C ON(B.CID = C.CID)
      WHERE B.STATUS = 'Y'
      ORDER BY BID DESC)
WHERE BTYPE = 1 AND ROWNUM BETWEEN 1 AND 10;



 -- CREATE OR REPLACE FORCE VIEW "JSP_SERVLET"."BLIST" ("RNUM", "BID", "BTYPE", "CNAME", "BTITLE", "BCONTENT", "NICKNAME", "BCOUNT", "CREATE_DATE", "MODIFY_DATE", "STATUS") AS 
  SELECT ROWNUM RNUM, BID, BTYPE, CNAME, BTITLE, BCONTENT, NICKNAME, BCOUNT, CREATE_DATE, MODIFY_DATE, STATUS
FROM (SELECT BID, BTYPE, CNAME, BTITLE, BCONTENT, NICKNAME, BCOUNT, B.CREATE_DATE, B.MODIFY_DATE, B.STATUS
      FROM BOARD B
      JOIN MEMBER M ON(B.BWRITER = M.USER_ID)
      JOIN CATEGORY C ON(B.CID = C.CID)
      WHERE B.STATUS = 'Y'
      ORDER BY BID DESC);